<!DOCTYPE html>
<html lang="ko">
<head>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ì–´ë–»ê²Œ?">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/3299/3299954.png"> ```
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì–´ë–»ê²Œ? ğŸš® - ë¶„ë¦¬ìˆ˜ê±° ê°€ì´ë“œ</title>
    <style>
        /* [ë””ìì¸ ì‹œìŠ¤í…œ & ê¸°ë³¸ ì„¤ì •] */
        :root {
            --bg-color: #FFFFFF;
            --main-green: #2E8B57; /* ì•ˆì •ê°ì„ ì£¼ëŠ” ì´ˆë¡ (SeaGreen) */
            --soft-green: #90EE90; /* ì—°ë‘ìƒ‰ (LightGreen) */
            --pastel-gray: #F0F2F0; /* íšŒë°±ìƒ‰ ë°°ê²½ */
            --text-gray: #555555;
            --highlight-green: #3CB371; /* í…ìŠ¤íŠ¸ ê°•ì¡° ì´ˆë¡ */
            --btn-gray: #E0E0E0;
        }

        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            font-family: 'Apple SD Gothic Neo', 'Noto Sans KR', sans-serif;
            background-color: var(--bg-color);
            overflow: hidden; /* ì•„ì´íŒ¨ë“œ ì•± ëŠë‚Œ */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* [ì•„ì´íŒ¨ë“œ 1920x1080 ë¹„ìœ¨ ì»¨í…Œì´ë„ˆ] */
        #app-container {
            width: 1920px; /* ì‹¤ì œ ë¹„ìœ¨ */
            height: 1080px;
            max-width: 100vw; /* í™”ë©´ì— ë§ì¶¤ */
            max-height: 100vh;
            position: relative;
            background-color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* [í—¤ë”: ë¡œê³ ] */
        header {
            width: 100%;
            height: 100px;
            display: flex;
            align-items: center;
            padding-left: 50px;
            box-sizing: border-box;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 10;
        }

        .logo-box {
            background: linear-gradient(135deg, var(--soft-green), var(--main-green));
            padding: 15px 30px;
            border-radius: 20px;
            color: white;
            font-size: 2rem;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s;
        }

        .logo-box:active {
            transform: scale(0.95);
        }

        /* [ë©”ì¸ ì˜ì—­ ê³µí†µ] */
        .content-area {
            flex: 1;
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            transition: opacity 0.5s ease;
        }

        /* 1. ì—…ë¡œë“œ í™”ë©´ */
        .upload-zone {
            width: 60%;
            height: 50%;
            border: 3px dashed var(--soft-green);
            border-radius: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            background-color: #FAFAFA;
            cursor: pointer;
            transition: all 0.3s;
        }

        .upload-zone:hover {
            background-color: #F0FFF0;
            border-color: var(--main-green);
        }

        .upload-text {
            font-size: 1.5rem;
            color: var(--text-gray);
            margin-top: 20px;
        }

        /* ìˆ¨ê²¨ì§„ íŒŒì¼ ì¸í’‹ */
        #file-input {
            display: none;
        }

        /* 2. ê°ì§€ ë° ê²°ê³¼ í…ìŠ¤íŠ¸ */
        #status-text {
            font-size: 3rem;
            font-weight: bold;
            color: #888; /* íŒŒìŠ¤í†¤ íšŒë°±ìƒ‰ ëŠë‚Œ */
            line-height: 1.5;
            min-height: 200px; /* í…ìŠ¤íŠ¸ ë³€ê²½ ì‹œ ë ˆì´ì•„ì›ƒ í”ë“¤ë¦¼ ë°©ì§€ */
        }

        .highlight-text {
            color: var(--highlight-green);
        }

        /* 3. ì„ íƒ ë²„íŠ¼ (ë°©ë²• vs ì˜ìƒ) */
        .button-group {
            display: none; /* ì´ˆê¸°ì—” ìˆ¨ê¹€ */
            margin-top: 50px;
            gap: 40px;
        }

        .action-btn {
            background-color: var(--pastel-gray); /* ì˜…ì€ íšŒìƒ‰ */
            color: black;
            font-size: 1.8rem;
            padding: 20px 60px;
            border-radius: 15px;
            border: none;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            transition: transform 0.1s, background-color 0.2s;
        }

        .action-btn:active, .action-btn.active-clicked {
            transform: scale(0.95);
            background-color: #D3D3D3; /* í´ë¦­ í‹°ë‚´ê¸° */
        }

        /* 4. ìƒì„¸ ì»¨í…ì¸  (ë°©ë²•/ì˜ìƒ) */
        #detail-view {
            width: 80%;
            height: 60%;
            background: white;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .step-container {
            display: flex;
            justify-content: space-around;
            width: 100%;
        }

        .step-box {
            width: 22%;
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .step-img {
            width: 100%;
            height: 150px;
            background-color: #ddd; /* ì‚¬ì§„ ë“¤ì–´ê°ˆ ìë¦¬ */
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #888;
        }

        .video-box {
            width: 100%;
            height: 100%;
            background-color: black;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            border-radius: 20px;
        }

        /* 5. ë˜ë‹¤ì‹œ ë²„íŠ¼ (í•˜ë‹¨) */
        .reset-bar {
            width: 100%;
            height: 80px;
            display: none; /* ì´ˆê¸°ì—” ìˆ¨ê¹€ */
            justify-content: center;
            position: absolute;
            bottom: 30px;
        }

        .reset-btn {
            background-color: #808080; /* íšŒìƒ‰ */
            color: white; /* í•˜ì–€ìƒ‰ */
            font-size: 1.5rem;
            padding: 15px 50px;
            border-radius: 50px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: transform 0.2s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .reset-btn:active {
            transform: scale(0.9);
        }

        /* ë¯¸ë¦¬ë³´ê¸° ì´ë¯¸ì§€ (ì¤‘ì•™ ë°°ì¹˜ìš©) */
        #preview-img {
            max-width: 300px;
            max-height: 300px;
            border-radius: 20px;
            margin-bottom: 30px;
            display: none;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

    </style>
</head>
<body>

    <div id="app-container">
        <header>
            <div class="logo-box" onclick="resetApp()">ì–´ë–»ê²Œ? ğŸš®</div>
        </header>

        <div class="content-area" id="main-content">
            
            <div class="upload-zone" id="upload-zone" onclick="triggerUpload()">
                <div style="font-size: 4rem;">ğŸ“·</div>
                <div class="upload-text">ì—¬ê¸°ë¥¼ ëˆŒëŸ¬ ì“°ë ˆê¸° ì‚¬ì§„ì„ ì˜¬ë ¤ì£¼ì„¸ìš”</div>
            </div>
            <input type="file" id="file-input" accept="image/*" onchange="handleFileSelect(this)">

            <img id="preview-img" src="" alt="ì—…ë¡œë“œëœ ì“°ë ˆê¸°">
            <div id="status-text" style="display: none;"></div>

            <div class="button-group" id="btn-group">
                <button class="action-btn" onclick="showInstruction()">ë¶„ë¦¬ìˆ˜ê±° ë°©ë²•</button>
                <button class="action-btn" onclick="showVideo()">ë¶„ë¦¬ìˆ˜ê±° ì˜ìƒ</button>
            </div>

            <div id="detail-view">
                </div>
        </div>

        <div class="reset-bar" id="reset-bar">
            <div class="reset-btn" onclick="resetApp()">
                ë˜ë‹¤ì‹œ â™¾ï¸
            </div>
        </div>
    </div>

<script>
    // =========================================================
    // [1. í‹°ì²˜ë¸” ë¨¸ì‹  ëª¨ë¸ URL ì„¤ì •]
    // ë‹¹ì‹ ì˜ Teachable Machine ëª¨ë¸ URLë¡œ ë°˜ë“œì‹œ ë³€ê²½í•˜ì„¸ìš”!
    const URL = "https://teachablemachine.withgoogle.com/models/ì—¬ê¸°ì—_ë‹¹ì‹ ì˜_ì£¼ì†Œë¥¼_ë„£ìœ¼ì„¸ìš”/"; 
    // =========================================================

    let model, maxPredictions;

    // 1-1. AI ëª¨ë¸ ì´ˆê¸°í™” (ì•± ì‹œì‘ ì‹œ í•œë²ˆ ì‹¤í–‰)
    async function initAI() {
        const modelURL = URL + "model.json";
        const metadataURL = URL + "metadata.json";

        try {
            model = await tmImage.load(modelURL, metadataURL);
            maxPredictions = model.getTotalClasses();
            console.log("AI ëª¨ë¸ ë¡œë”© ì™„ë£Œ!");
        } catch (e) {
            console.error("ëª¨ë¸ ë¡œë”© ì‹¤íŒ¨. URLì„ í™•ì¸í•˜ê±°ë‚˜ CORS ì„¤ì • ë¬¸ì œì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.", e);
        }
    }
    
    // í˜ì´ì§€ ë¡œë“œ ì‹œ AI ì¤€ë¹„ ì‹œì‘
    window.onload = initAI;

    // [2. DOM ì—˜ë¦¬ë¨¼íŠ¸ ë° ìƒíƒœ ë³€ìˆ˜]
    const uploadZone = document.getElementById('upload-zone');
    const fileInput = document.getElementById('file-input');
    const previewImg = document.getElementById('preview-img');
    const statusText = document.getElementById('status-text');
    const btnGroup = document.getElementById('btn-group');
    const detailView = document.getElementById('detail-view');
    const resetBar = document.getElementById('reset-bar');

    let detectedCategory = ""; 
    let detectedSpecific = ""; 

    function triggerUpload() { fileInput.click(); }

    function handleFileSelect(input) {
        if (!model) {
            alert("AI ëª¨ë¸ ë¡œë”© ì¤‘ì…ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
            return;
        }

        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = function(e) {
                uploadZone.style.display = 'none';
                previewImg.src = e.target.result;
                previewImg.style.display = 'block';
                statusText.style.display = 'block';
                
                // ì´ë¯¸ì§€ê°€ ë¡œë”©ëœ í›„ì— AI ì˜ˆì¸¡ ì‹œì‘
                previewImg.onload = function() {
                    startDetectionProcess();
                }
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    // 3. AI ê°ì§€ ë¡œì§ (ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ + ì‹¤ì œ ì˜ˆì¸¡)
    async function startDetectionProcess() {
        
        // 3-1. ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
        let dots = 0;
        const loadingInterval = setInterval(() => {
            dots = (dots % 3) + 1;
            statusText.innerHTML = `ê°ì§€ì¤‘ ${".".repeat(dots)}`;
        }, 300);

        // 3-2. AI ì˜ˆì¸¡ ìˆ˜í–‰ (predict)
        // ì˜ˆì¸¡ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.
        const prediction = await model.predict(previewImg);
        
        // 3-3. ê°€ì¥ ë†’ì€ í™•ë¥ ì˜ ì“°ë ˆê¸° ì°¾ê¸° ë° ë¶„ì„
        let highestProbability = 0;
        let bestClass = "";

        for (let i = 0; i < maxPredictions; i++) {
            if (prediction[i].probability > highestProbability) {
                highestProbability = prediction[i].probability;
                bestClass = prediction[i].className;
            }
        }

        // ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ ì¢…ë£Œ
        clearInterval(loadingInterval);

        // í´ë˜ìŠ¤ ì´ë¦„ ë¶„ì„ (ì˜ˆ: "í”Œë¼ìŠ¤í‹±_ë¹ˆ í˜íŠ¸ë³‘")
        const splitName = bestClass.split('_');
        
        if (splitName.length >= 2) {
            detectedCategory = splitName[0]; 
            detectedSpecific = splitName[1]; 
        } else {
            // ì–¸ë”ë°”ê°€ ì—†ì„ ê²½ìš° ëŒ€ë¹„
            detectedCategory = "ì¼ë°˜ì“°ë ˆê¸°";
            detectedSpecific = bestClass;
        }
        
        // 3-4. ë‹¨ê³„ë³„ ê²°ê³¼ í‘œì‹œ ì‹œì‘
        showFirstDetection();
    }

    // 4. ê°ì§€ ê²°ê³¼ í‘œì‹œ í•¨ìˆ˜ë“¤ (ì´ì „ê³¼ ë™ì¼)

    function showFirstDetection() {
        // 1ì°¨ ê°ì§€ ê²°ê³¼ ì¶œë ¥ (ì¹´í…Œê³ ë¦¬)
        statusText.innerHTML = `ì•„í•˜ !<br>ì´ ì“°ë ˆê¸°ëŠ” <span class="highlight-text">${detectedCategory}</span>ì´êµ°ìš”!`;
        
        setTimeout(() => {
            showSecondDetection();
        }, 2000);
    }

    function showSecondDetection() {
        // 2ì°¨ ê°ì§€ ê²°ê³¼ ì¶œë ¥ (êµ¬ì²´ì  ì´ë¦„)
        statusText.innerHTML = `ì•„í•˜ !<br>ì´ ì“°ë ˆê¸°ëŠ” <span class="highlight-text">${detectedSpecific}</span>ì´êµ°ìš”!`;
        
        setTimeout(() => {
            showComplete();
        }, 2000);
    }

    function showComplete() {
        previewImg.style.display = 'none'; 
        statusText.innerHTML = `ê°ì§€ ì™„ë£Œ ! ğŸŒ¿`;
        statusText.style.color = "var(--main-green)"; 
        btnGroup.style.display = 'flex';
    }

    // 5. ìƒì„¸ ì •ë³´ í‘œì‹œ í•¨ìˆ˜ë“¤ (ì´ì „ê³¼ ë™ì¼)

    function showInstruction() {
        statusText.style.display = 'none'; 
        btnGroup.style.display = 'none';   
        detailView.style.display = 'flex';
        
        // detectedSpecific ê°’ì— ë”°ë¥¸ ë¶„ë¦¬ìˆ˜ê±° ë°©ë²• ì•ˆë‚´
        detailView.innerHTML = `
            <h2 style="color:var(--main-green); margin-bottom:30px;">ë¶„ë¦¬ìˆ˜ê±° ë°©ë²• (${detectedSpecific})</h2>
            <div class="step-container">
                <div class="step-box"><div class="step-img">ì‚¬ì§„ 1</div><div>ë‚´ìš©ë¬¼ ë¹„ìš°ê¸°</div></div>
                <div class="step-box"><div class="step-img">ì‚¬ì§„ 2</div><div>ì´ë¬¼ì§ˆ ì œê±°</div></div>
                <div class="step-box"><div class="step-img">ì‚¬ì§„ 3</div><div>ì°Œê·¸ëŸ¬ëœ¨ë¦¬ê¸°</div></div>
                <div class="step-box"><div class="step-img">ì‚¬ì§„ 4</div><div>ëšœê»‘ ë‹«ê¸°</div></div>
            </div>
        `;
        resetBar.style.display = 'flex';
    }

    function showVideo() {
        statusText.style.display = 'none';
        btnGroup.style.display = 'none';
        detailView.style.display = 'flex';
        detailView.innerHTML = `<div class="video-box">â–¶ï¸ ${detectedSpecific} ë¶„ë¦¬ìˆ˜ê±° ì˜ìƒ ì¬ìƒ ì¤‘...</div>`;
        resetBar.style.display = 'flex';
    }

    // 6. ì´ˆê¸°í™” í•¨ìˆ˜ (ì´ì „ê³¼ ë™ì¼)

    function resetApp() {
        uploadZone.style.display = 'flex';
        fileInput.value = ''; 
        previewImg.style.display = 'none';
        statusText.style.display = 'none';
        statusText.style.color = '#888';
        btnGroup.style.display = 'none';
        detailView.style.display = 'none';
        resetBar.style.display = 'none';
        statusText.innerHTML = '';
        
        detectedCategory = "";
        detectedSpecific = "";
    }
</script>
</body>
</html>

